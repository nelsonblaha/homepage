# Fail2ban filter for blaha-homepage failed login attempts
# Place in /etc/fail2ban/filter.d/blaha-homepage.conf

[Definition]
# Match failed login attempts (401 on /api/admin/login)
# Docker JSON log format: {"log":"INFO: IP - \"POST /api/admin/login HTTP/1.1\" 401\n","stream":"stdout","time":"..."}
failregex = ^.*"log":"INFO:\s+<HOST>:\d+\s+-\s+\"POST\s+/api/admin/login\s+HTTP/[^\"]+\"\s+401\s+.*$

# Also catch invalid friend token attempts (404 on /f/ or /api/f/)
            ^.*"log":"INFO:\s+<HOST>:\d+\s+-\s+\"GET\s+/f/[^\s]+\s+HTTP/[^\"]+\"\s+404\s+.*$
            ^.*"log":"INFO:\s+<HOST>:\d+\s+-\s+\"GET\s+/api/f/[^\s]+\s+HTTP/[^\"]+\"\s+404\s+.*$

ignoreregex =
